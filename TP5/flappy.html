<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1440, initial-scale=1.0">
    <title>PokeJuegos - Blocka: Armando Pokemones</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/juego.css">
    <link rel="icon" type="image/png" href="img/logo-reg-ini.png">
</head>

<body>

    <nav class="sidebar-categorias" id="sidebarCategorias">
        <!-- El bot√≥n de cerrar se elimina, solo se usa el de header -->
        <ul class="sidebar-list">
            <li id="sidebarInicio"><img class="clickeable" src="img/icon-menu/icon-home.png"> INICIO</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-futbol.png"> FUTBOL</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-medicina.png"> MEDICINA</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-misterio.png"> MISTERIO</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-novedades.png"> NOVEDADES</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-fotografia.png"> FOTOGRAFIA</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-arte.png"> ARTE</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-cocina.png"> COCINA</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-stickman.png"> STICKMAN</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-vestir.png"> VESTIR</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-universo.png"> UNIVERSO</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-controlador.png"> CONTROLADOR</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-ciencia.png"> CIENCIA</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-ciclismo.png"> CICLISMO</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-autos.png"> AUTOS</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-barcos.png"> BARCOS</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-belleza.png"> BELLEZA</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-baloncesto.png"> BALONCESTO</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-mascota.png"> MASCOTA</li>
            <li class="clickeable"><img class="clickeable" src="img/icon-menu/icon-multijugador.png"> MULTIJUGADOR</li>
        </ul>
    </nav>
    <header class="header">
        <div class="header-left">
            <div class="hamburguesa-icon"><img src="img/Hamburguesa.png"></div>
            <img src="img/icon-home-logo.png" alt="Logo" class="logo-header clickeable">
            <a href="./home.html" class="title-header">POKEJUEGOS</a>
        </div>

        <div class="header-center">
            <div class="search-container">
                <input type="text" class="search-bar" id="searchInput" placeholder="Buscar...">
                <button type="button" class="icon-search-button" onclick="clearSearch()">
                    <img src="img/icon-search.png" class="icon-search-in-input">
                </button>
            </div>
        </div>

        <div class="header-right">
            <div class="icon-cart clickeable"><img src="img/icon-cart.png"></div>
            <div class="icon-profile" id="profileMenuBtn">
                <img src="img/icon-profile.png">
                <div class="profile-menu" id="profileMenu">
                    <ul>
                        <li><img src="img/icon-profile/icon-profile.png" class="profile-menu-icon"> PERFIL</li>
                        <li><img src="img/icon-profile/icon-keep.png" class="profile-menu-icon"> MIS JUEGOS</li>
                        <li><img src="img/icon-profile/icon-Settings.png" class="profile-menu-icon"> CONFIGURACION</li>
                        <li><a href="index.html"><img src="img/icon-profile/icon-outsession.png"
                                    class="profile-menu-icon"> CERRAR SESION</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>
    </header>
    <div class="main-flex">
        <div class="main-content-comments">
            <main class="main-content">
                <nav class="breadcrumb">
                    <a href="./home.html">Home</a> <span class="breadcrumb-sep">></span> <span> Flappy Magi: Esquivando obstaculos con magikarp</span>
                </nav>
                <section class="game-section">
                    <div class="game-container-flappy">
                        <!-- Fondo Parallax -->
                        <div class="parallax-container">
                            <!-- Fondo - z-index 1 -->
                            <div class="layer fondo">
                                <img src="img/img-tp5/1.png" alt="Fondo cielo">
                                <img src="img/img-tp5/1.png" alt="Fondo cielo duplicado">
                            </div>
                            <!-- Agua - z-index 2 -->
                            <div class="layer agua">
                                <img src="img/img-tp5/2.png" alt="Agua">
                                <img src="img/img-tp5/2.png" alt="Agua duplicada">
                            </div>
                            <!-- Playa - z-index 3 -->
                            <div class="layer playa">
                                <img src="img/img-tp5/3.png" alt="Playa">
                                <img src="img/img-tp5/3.png" alt="Playa duplicada">
                            </div>
                            <!-- Nubes - z-index 4 -->
                            <div class="layer nubes">
                                <img src="img/img-tp5/4.png" alt="Nubes">
                                <img src="img/img-tp5/4.png" alt="Nubes duplicadas">
                            </div>
                        </div>
                        <!-- Juego Flappy -->
                        <div id="magikarp"></div>
                        <div class="score" id="score">0</div>
                        <div class="coin-counter" id="coinCounter" style="display: flex; align-items: center; gap: 8px; position: absolute; top: 30px; left: 50%; transform: translateX(-50%); z-index: 21;">
                            <span class="coin-icon"></span><span id="coinCount">0</span>
                        </div>
                        <div class="screen" id="startScreen">
                            <div class="contenedor-juego">
                                <h1 class="title">MAGIKARP FLAPPY</h1>
                                <p class="subtitle">Esquiva los obst√°culos y recoge monedas</p>
                                <div class="menu-buttons">
                                    <button class="botones btn-primary" id="startButton">INICIAR</button>
                                    <button class="botones btn-instrucciones" id="showInstructionsBtn">Instrucciones</button>
                                </div>
                            </div>
                        </div>

                        <!-- INSTRUCCIONES -->
                        <div id="instructions" class="screen hidden">
                            <div class="contenedor-juego">
                                <h2 class="title">Instrucciones</h2>
                                <div class="instructions-content">
                                    <div class="instruction-item">
                                        <h3>üéØ Objetivo</h3>
                                        <p>Consigue 20 puntos esquivando obst√°culos o recolecta 10 monedas para ganar. ¬°Elige el camino m√°s f√°cil!</p>
                                    </div>
                                    <div class="instruction-item">
                                        <h3>üéÆ Controles</h3>
                                        <p><strong>Barra Espaciadora o Click:</strong> Salta para evitar los obst√°culos y recoger monedas.</p>
                                    </div>
                                    <div class="instruction-item">
                                        <h3>‚ö†Ô∏è Peligros</h3>
                                        <p>Evita las torres que salen del lado derecho. Tambi√©n cuidado con los Mantines enemigos dentro de los huecos.</p>
                                    </div>
                                </div>
                                <button class="botones btn-instrucciones" id="backToMenuBtn">Volver</button>
                            </div>
                        </div>

                        <div class="screen hidden" id="gameOverScreen">
                            <div class="contenedor-juego">
                                <h1 class="title">GAME OVER</h1>
                                <div class="instructions-content">
                                    <div class="instruction-item">
                                        <h3 style="text-align: center;">Puntuaci√≥n: <span id="finalScore">0</span></h3>
                                    </div>
                                </div>
                                <div class="menu-buttons">
                                    <button class="botones btn-primary" id="restartButton">REINTENTAR</button>
                                </div>
                            </div>
                        </div>
                        <div class="screen hidden" id="victoryScreen">
                            <div class="contenedor-juego">
                                <h1 class="title">¬°VICTORIA!</h1>
                                <div class="instructions-content">
                                    <div class="instruction-item">
                                        <h3 style="text-align: center;">Puntuaci√≥n: <span id="victoryScore">0</span></h3>
                                        <h3 style="text-align: center;">Monedas: <span id="victoryCoins">0</span></h3>
                                    </div>
                                </div>
                                <div class="menu-buttons">
                                    <button class="botones btn-primary" id="victoryButton">REINICIAR</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </main>

            <div class="game-descripcion">
                <h4>Flappy Magi: Esquivando obstaculos con magikarp</h4>
                <div class="descripcion-juego-imagen">
                    <div class="descripcion-juego">
                        <h5>¬øQu√© es Flappy Magi?</h5>
                        <p>Flappy Magi es un desafiante juego de habilidad donde debes controlar a un personaje para evitar obst√°culos y avanzar la mayor distancia posible. Ideal para quienes disfrutan de juegos r√°pidos y entretenidos que ponen a prueba sus reflejos.</p>
                            disfrutan de los juegos de l√≥gica y observaci√≥n, con niveles que aumentan la dificultad y
                            a√±aden un toque art√≠stico.</p>

                            <p>Objetivo:
                           Esquivan todos los obst√°culos y avanza la mayor distancia posible, no olvides agarrar las monedas.</p>

                        <h5>Instrucciones r√°pidas:</h5>
                        <ul>
                            <li>Click Izquierdo o Barra Espaciadora: Salta</li>
                            <li>Consta de un solo nivel donde debes esquivar obst√°culos y recoger monedas mientras avanzas.</li>

                        </ul>
                    </div>
                   <div class="descripcion-div">
                        <div class="imagen-descripcion">
                            <img src="./img/flappy-card.png" alt="imagen mas chica de Flappy Magi"
                                srcset="">
                        </div>
                        <div class="compartir-row">
                            <!-- <img src="./img/juego/btn-share.png" alt="boton compartir" class="btn-compartir-img"> -->
                            <button class="btn-compartir btn-compartir-img btn btn-expand-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="white"
                                    viewBox="0 0 24 24">
                                    <path
                                        d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.02-4.11A2.99 2.99 0 0018 7.91a3 3 0 10-3-3c0 .24.04.47.09.7l-7.02 4.11A2.99 2.99 0 006 9a3 3 0 100 6c1.19 0 2.22-.66 2.73-1.63l7.14 4.18c-.05.21-.08.43-.08.65a3 3 0 103-3z" />
                                </svg>
                                Compartir
                            </button>
                        </div>
                    </div>
                </div>
                <div class="carrousel-container">
                    <button class="carrousel-btn prev">&#10094;</button>
                    <div class="carrousel-img" id="carrousel">
                        <img src="./img/flappycarro1.png" alt="Muestra 1" class="carrousel-img-item clickeable">
                        <img src="./img/flappycarro2.png" alt="Muestra 2" class="carrousel-img-item clickeable">
                        <img src="./img/flappycarro3.jpg" alt="Muestra 3" class="carrousel-img-item clickeable">
                    </div>
                    <button class="carrousel-btn next">&#10095;</button>
                </div>

            </div>

            <!-- MODAL COMPARTIR -->
            <div id="modalCompartir" class="modal-compartir">
                <div class="modal-compartir-content">
                    <span class="modal-compartir-close" id="closeCompartir">&#10006;</span>
                    <h2>Compartir con:</h2>
                    <div class="modal-compartir-grid">
                        <a href="https://www.instagram.com/" target="_blank"><img
                                src="img/fat-footer/icon-instagram.png"><span>Instagram</span></a>
                        <a href="mailto:?subject=¬°Mir√° este juego!&body=www.pokejuegos.com/peg-solitaire"
                            target="_blank"><img src="img/fat-footer/icon-gmail.png"><span>Gmail</span></a>
                        <a href="https://wa.me/?text=www.pokejuegos.com/peg-solitaire" target="_blank"><img
                                src="img/fat-footer/icon-whatsapp.png"><span>WhatsApp</span></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=www.pokejuegos.com/peg-solitaire"
                            target="_blank"><img src="img/fat-footer/icon-facebook.png"><span>Facebook</span></a>
                        <a href="https://www.messenger.com/" target="_blank"><img
                                src="img/fat-footer/icon-messenger.png"><span>Messenger</span></a>
                        <a href="https://discord.com/" target="_blank"><img
                                src="img/fat-footer/icon-discord.png"><span>Discord</span></a>
                        <a href="https://t.me/share/url?url=www.pokejuegos.com/peg-solitaire" target="_blank"><img
                                src="img/fat-footer/icon-telegram.png"><span>Telegram</span></a>
                        <a href="https://www.tiktok.com/" target="_blank"><img
                                src="img/fat-footer/icon-tiktok.png"><span>TikTok</span></a>
                    </div>
                    <div class="modal-compartir-link">
                        Link de la pagina: <a href="./home.html" target="_blank">www.pokejuegos.com/peg-solitaire</a>
                    </div>
                </div>
            </div>






            <section class="comments-section">
                <div class="comments-header">
                    <h4>Comentarios</h4>
                    <img src="./img/juego/icon-comments.png" alt="icono comentarios">
                </div>
                <form class="comment-form">
                    <div class="comment-form-user">
                        <img src="./img/juego/comentario-tu.png" alt="User" class="comment-user-img clickeable">
                        <span class="comment-user-name">Tu</span>
                    </div>
                    <div class="icon-separador">
                        <img src="./img/juego/icon-separador-comentario.png" alt="Separador" class="icon-separador-img">
                    </div>
                    <input class="comment-input-text" placeholder="Escribir un comentario sobre este juego..."
                        name="comment"></input>
                    <div class="comment-form-stars-actions">
                        <div class="comment-form-stars">
                            <span class="star" data-value="1">‚òÖ</span>
                            <span class="star" data-value="2">‚òÖ</span>
                            <span class="star" data-value="3">‚òÖ</span>
                            <span class="star" data-value="4">‚òÖ</span>
                            <span class="star" data-value="5">‚òÖ</span>
                        </div>
                        <button type="reset" class="comment-submit-btn btn btn-slide-diagonal">Enviar
                            <span>‚ñ∂</span></button>
                    </div>
                </form>


                <div class="comment-box">
                    <div class="comment-user">
                        <img src="./img/juego/icon-comentarios-user.png" alt="User" class="comment-user-img clickeable">
                        <span class="comment-user-name clickeable">AshKetchum</span>
                        <div class="comment-rating">
                            <span class="star-selected" data-value="1">‚òÖ</span>
                            <span class="star-selected" data-value="2">‚òÖ</span>
                            <span class="star-selected" data-value="3">‚òÖ</span>
                            <span class="star-selected" data-value="4">‚òÖ</span>
                            <span class="star-selected" data-value="5">‚òÖ</span>
                        </div>

                    </div>
                    <p class="comment-text">Muy Bueno, me encanto.</p>
                </div>
                <div class="comment-box">
                    <div class="comment-user">
                        <img src="./img/juego/icon-comentarios-user.png" alt="User" class="comment-user-img clickeable">
                        <span class="comment-user-name clickeable">Misty</span>
                        <div class="comment-rating">
                            <span class="star-selected" data-value="1">‚òÖ</span>
                            <span class="star-selected" data-value="2">‚òÖ</span>
                            <span class="star-selected" data-value="3">‚òÖ</span>
                            <span class="star-selected" data-value="4">‚òÖ</span>
                            <span class="star" data-value="5">‚òÖ</span>
                        </div>
                    </div>
                    <p class="comment-text">Muy divertido, pero dif√≠cil de ganar.</p>
                </div>
                <div class="comment-box">
                    <div class="comment-user">
                        <img src="./img/juego/icon-comentarios-user.png" alt="User" class="comment-user-img clickeable">
                        <span class="comment-user-name clickeable">Brock</span>
                        <div class="comment-rating">
                            <span class="star-selected" data-value="1">‚òÖ</span>
                            <span class="star-selected" data-value="2">‚òÖ</span>
                            <span class="star-selected" data-value="3">‚òÖ</span>
                            <span class="star-selected" data-value="4">‚òÖ</span>
                            <span class="star-selected" data-value="5">‚òÖ</span>
                        </div>
                    </div>
                    <p class="comment-text">¬°Ideal para pasar el rato!</p>
                </div>
            </section>
        </div>
        <aside class="game-sidebar">
            <ul class="sidebar-games">
                <li><img class="clickeable" src="./img/cards/Cars.png" alt="Game 1"></li>
                <li><img class="clickeable" src="./img/cards/Words.png" alt="Game 2"></li>
                <li><img class="clickeable" src="./img/cards/Redball.png" alt="Game 3"></li>
                <li><img class="clickeable" src="./img/cards/Merge.png" alt="Game 4"></li>
                <li><img class="clickeable" src="./img/cards/Minicraft.png" alt="Game 5"></li>
                <li><img class="clickeable" src="./img/cards/Deluxe.png" alt="Game 6"></li>
                <li><img class="clickeable" src="./img/cards/Motos.png" alt="Game 7"></li>
                <li><img class="clickeable" src="./img/cards/plantas.png" alt="Game 8"></li>
                <li><img class="clickeable" src="./img/cards/Counter.jpg" alt="Game 8"></li>
                <li><img class="clickeable" src="./img/cards/Words.png" alt="Game 8"></li>
                <li><img class="clickeable" src="./img/cards/Aguafuego.png" alt="Game 8"></li>
            </ul>
        </aside>
    </div>
    <footer class="footer">
        <div class="pokefat-footer">
            <div class="fat-footer-juegos">
                <div class="footer-juegos-bloque">
                    <h4>Juegos</h4>
                    <ul>
                        <li>Among Us</li>
                        <li>Moto X3M</li>
                        <li>Fireboy and Watergirl</li>
                        <li>Slither.io</li>
                        <li>Minicraft</li>
                        <li>Red Ball 4</li>
                    </ul>
                </div>
                <div class="footer-juegos-bloque">
                    <h4>Populares</h4>
                    <ul>
                        <li>Obby Escape</li>
                        <li>Wordling</li>
                        <li>Brainrot: Ice Truck</li>
                        <li>Merge Fantasy</li>
                        <li>Cars: Lightning Speed</li>
                        <li>Steal a Brainrot 3D</li>
                    </ul>
                </div>
                <div class="footer-juegos-bloque">
                    <h4>Con Logros</h4>
                    <ul>
                        <li>Autobahn: M5 Drift</li>
                        <li>Call of Terror</li>
                        <li>Fly the Plane!</li>
                        <li>Counter-Terror: Global Strike</li>
                        <li>Heroes of War</li>
                        <li>F1 Racing PRO</li>
                    </ul>
                </div>
            </div>
            <div class="fat-footer-divider"><span class="pokeball-divider"><img
                        src="img/icon-separador-vertical.png"></span></div>
            <div class="fat-footer-redes">
                <ul class="redes-list">
                    <li><img src="img/fat-footer/icon-facebook.png"> Facebook</li>
                    <li><img src="img/fat-footer/icon-instagram.png"> Instagram</li>
                    <li><img src="img/fat-footer/icon-twitter.png"> Twitter</li>
                </ul>
            </div>
            <div class="fat-footer-redes">
                <ul class="redes-list">
                    <li><img src="img/fat-footer/icon-contactanos.png" alt="Contactanos"> Contactanos</li>
                    <li><img src="img/fat-footer/icon-tiktok.png" alt="TikTok"> Tik Tok</li>
                    <li><img src="img/fat-footer/icon-telegram.png" alt="Telegram"> Telegram</li>
                </ul>
            </div>
            <div class="fat-footer-divider"><span class="pokeball-divider"><img
                        src="img/icon-separador-vertical.png"></span></div>
            <div class="fat-footer-col compania-footer">
                <ul>
                    <li>Novedades</li>
                    <li>T√©rminos de uso</li>
                    <li>Privacidad</li>
                    <li>Cookies</li>
                    <li>Ayuda</li>
                </ul>
            </div>
        </div>
    </footer>
    </main>
    <script>
// Flappy Magikarp - Versi√≥n simplificada para contenedor redimensionado
document.addEventListener('DOMContentLoaded', function() {
    const gameContainer = document.querySelector('.game-container-flappy');
    const magikarp = document.getElementById('magikarp');
    const scoreDisplay = document.getElementById('score');
    const startScreen = document.getElementById('startScreen');
    const gameOverScreen = document.getElementById('gameOverScreen');
    const finalScoreDisplay = document.getElementById('finalScore');
    const startButton = document.getElementById('startButton');
    const restartButton = document.getElementById('restartButton');
    const coinCountDisplay = document.getElementById('coinCount');
    const instructionsScreen = document.getElementById('instructions');
    const showInstructionsBtn = document.getElementById('showInstructionsBtn');
    const backToMenuBtn = document.getElementById('backToMenuBtn');

    let gameWidth = gameContainer.offsetWidth;
    let gameHeight = gameContainer.offsetHeight;

    let magiPosition = gameHeight / 2.4;
    let magiVelocity = 0;
    let gravity = 0.6;
    let jumpStrength = -10;
    let gameRunning = false;
    let score = 0;
    let obstacles = [];
    let coins = [];
    let kyogres = [];
    let coinScore = 0;
    let gameLoop;
    let obstacleInterval;
    let coinInterval;
    let kyogreTimer = null;
    let allowBoundaryDeath = false;

    const obstacleGap = 300;
    const obstacleSpeed = 3;
    const obstacleFrequency = 2000;
    const coinFrequency = 4000;

    function init() {
        magiPosition = gameHeight / 2.4;
        magiVelocity = 0;
        score = 0;
        obstacles = [];
        coins = [];
        coinScore = 0;
        scoreDisplay.textContent = score;
        coinCountDisplay.textContent = coinScore;
        magikarp.style.top = magiPosition + 'px';
        magikarp.classList.remove('dead');
        document.querySelectorAll('.obstacle').forEach(obs => obs.remove());
        document.querySelectorAll('.coin').forEach(c => c.remove());
        document.querySelectorAll('.mantine').forEach(w => w.remove());
        document.querySelectorAll('.kyogre').forEach(k => k.remove());
        kyogres = [];
    }

    function startGame() {
        gameWidth = gameContainer.offsetWidth;
        gameHeight = gameContainer.offsetHeight;
        init();
        startScreen.classList.add('hidden');
        gameOverScreen.classList.add('hidden');
        gameRunning = true;
        allowBoundaryDeath = false;
        setTimeout(() => { allowBoundaryDeath = true; }, 600);
        gameLoop = setInterval(update, 1000 / 60);
        obstacleInterval = setInterval(createObstacle, obstacleFrequency);
        coinInterval = setInterval(createCoin, coinFrequency);
        scheduleNextKyogre();
    }

    function scheduleNextKyogre() {
        if (kyogreTimer) clearTimeout(kyogreTimer);
        kyogreTimer = setTimeout(() => {
            createKyogre();
            scheduleNextKyogre();
        }, 7000);
    }

    function jump() {
        if (!gameRunning) return;
        magiVelocity = jumpStrength;
    }

    function update() {
        if (!gameRunning) return;
        
        magiVelocity += gravity;
        magiPosition += magiVelocity;
        magikarp.style.top = magiPosition + 'px';
        
        let rotation = Math.min(Math.max(magiVelocity * 3, -30), 90);
        magikarp.style.transform = `rotate(${rotation}deg)`;
        
        const techoLimite = -50;
        const pisoLimite = gameHeight - 20;
        if (allowBoundaryDeath && (magiPosition < techoLimite || magiPosition > pisoLimite)) {
            endGame(false);
            return;
        }
        
        const magiWidth = 60;
        const magiHeight = 42;
        const magiLeft = gameWidth * 0.3 - magiWidth / 2;
        const magiTop = magiPosition + 7;
        const magiRight = magiLeft + magiWidth;
        const magiBottom = magiTop + magiHeight;

        for (let i = obstacles.length - 1; i >= 0; i--) {
            const obstacle = obstacles[i];
            obstacle.left -= obstacleSpeed;
            obstacle.topElement.style.left = obstacle.left + 'px';
            obstacle.bottomElement.style.left = obstacle.left + 'px';
            
            // Actualizar posici√≥n del Mantine
            if (obstacle.mantineElement) {
                obstacle.mantineElement.style.left = obstacle.left + 'px';
            }
            
            if (!obstacle.passed && magiLeft > obstacle.left + 80) {
                obstacle.passed = true;
                score++;
                scoreDisplay.textContent = score;
                if (score >= 20 || coinScore >= 10) {
                    showVictoryScreen();
                    return;
                }
            }
            
            if (obstacle.left < -80) {
                obstacle.topElement.remove();
                obstacle.bottomElement.remove();
                if (obstacle.mantineElement) obstacle.mantineElement.remove();
                obstacles.splice(i, 1);
                continue;
            }
            
            const obstacleLeft = obstacle.left;
            const obstacleRight = obstacle.left + 80;
            const gapTop = obstacle.gapTop;
            const gapBottom = obstacle.gapTop + obstacleGap;
            const horizontalCollision = magiRight > obstacleLeft && magiLeft < obstacleRight;
            const topCollision = magiTop < gapTop && horizontalCollision;
            const bottomCollision = magiBottom > gapBottom && horizontalCollision;
            if (topCollision || bottomCollision) {
                endGame(true);
                return;
            }
            
            // Colisi√≥n con Mantine (hitbox circular)
            if (obstacle.mantineElement) {
                const mCenterX = obstacle.left + 30;
                const mCenterY = parseFloat(obstacle.mantineElement.style.top) + 20;
                const mantineRadiusFactor = 0.7;
                const radius = Math.max(60, 40) / 2 * mantineRadiusFactor;
                const hitMantine = rectCircleCollides(magiLeft, magiTop, magiRight, magiBottom, mCenterX, mCenterY, radius);
                if (hitMantine) {
                    endGame(true);
                    return;
                }
            }
        }

        for (let i = coins.length - 1; i >= 0; i--) {
            const coin = coins[i];
            coin.left -= obstacleSpeed;
            coin.element.style.left = coin.left + 'px';
            
            if (coin.left < -20) {
                coin.element.remove();
                coins.splice(i, 1);
                continue;
            }
            
            const coinLeft = coin.left;
            const coinRight = coin.left + 20;
            const coinTop = coin.top;
            const coinBottom = coin.top + 20;
            const collide = magiRight > coinLeft && magiLeft < coinRight && magiBottom > coinTop && magiTop < coinBottom;
            
            if (collide) {
                const el = coin.element;
                if (!el.classList.contains('coin-picked')) {
                    coinScore += 1;
                    coinCountDisplay.textContent = coinScore;
                    el.classList.add('coin-picked');
                    el.addEventListener('animationend', () => {
                        try { el.remove(); } catch (e) {}
                        const idx = coins.indexOf(coin);
                        if (idx !== -1) coins.splice(idx, 1);
                    }, { once: true });

                    if (score >= 20 || coinScore >= 10) {
                        showVictoryScreen();
                        return;
                    }
                }
            }
        }

        for (let i = kyogres.length - 1; i >= 0; i--) {
            const k = kyogres[i];
            k.left -= k.speed;
            k.element.style.left = k.left + 'px';
            if (k.left < -50) {
                k.element.remove();
                kyogres.splice(i, 1);
            }
        }
    }

    function rectCircleCollides(rectLeft, rectTop, rectRight, rectBottom, circleX, circleY, radius) {
        const closestX = Math.max(rectLeft, Math.min(circleX, rectRight));
        const closestY = Math.max(rectTop, Math.min(circleY, rectBottom));
        const dx = circleX - closestX;
        const dy = circleY - closestY;
        return (dx * dx + dy * dy) <= (radius * radius);
    }

    function showVictoryScreen() {
        gameRunning = false;
        clearInterval(gameLoop);
        clearInterval(obstacleInterval);
        clearInterval(coinInterval);
        const victoryEl = document.getElementById('victoryScreen');
        if (victoryEl) {
            startScreen.classList.add('hidden');
            gameOverScreen.classList.add('hidden');
            document.getElementById('victoryScore').textContent = score;
            document.getElementById('victoryCoins').textContent = coinScore;
            victoryEl.classList.remove('hidden');
            const vBtn = document.getElementById('victoryButton');
            if (vBtn) {
                vBtn.replaceWith(vBtn.cloneNode(true));
                document.getElementById('victoryButton').addEventListener('click', () => {
                    victoryEl.classList.add('hidden');
                    startGame();
                });
            }
        }
    }

    function createCoin() {
        if (!gameRunning) return;
        
        let gapTop = null;
        let gapLeft = gameWidth;
        for (let i = 0; i < obstacles.length; i++) {
            if (obstacles[i].left > gameWidth * 0.5) {
                gapTop = obstacles[i].gapTop;
                gapLeft = obstacles[i].left;
                break;
            }
        }
        
        let coinTop;
        if (gapTop !== null) {
            coinTop = gapTop + obstacleGap / 2 - 10;
        } else {
            coinTop = Math.random() * (gameHeight - 250) + 100;
        }
        
        const coin = document.createElement('div');
        coin.className = 'coin';
        coin.style.left = gapLeft + 'px';
        coin.style.top = coinTop + 'px';
        gameContainer.appendChild(coin);
        coins.push({
            left: gapLeft,
            top: coinTop,
            width: 20,
            height: 20,
            element: coin
        });
    }

    function createKyogre() {
        if (!gameRunning) return;
        if (kyogres.length > 2) return;
        
        const ky = document.createElement('div');
        ky.className = 'kyogre';
        const initialLeft = gameWidth;
        ky.style.left = initialLeft + 'px';
        const top = Math.random() * (gameHeight - 100) + 50;
        ky.style.top = top + 'px';
        gameContainer.appendChild(ky);

        const speed = 1.6 + Math.random() * 1.2;
        kyogres.push({
            left: initialLeft,
            top: top,
            width: 50,
            height: 59,
            element: ky,
            speed: speed
        });
    }

    function createObstacle() {
        if (!gameRunning) return;
        
        const minGapTop = 80;
        const maxGapTop = gameHeight - obstacleGap - 80;
        const gapTop = Math.random() * (maxGapTop - minGapTop) + minGapTop;
        
        const topObstacle = document.createElement('div');
        topObstacle.classList.add('obstacle', 'obstacle-top');
        topObstacle.style.left = gameWidth + 'px';
        topObstacle.style.height = gapTop + 'px';
        gameContainer.appendChild(topObstacle);
        
        const bottomObstacle = document.createElement('div');
        bottomObstacle.classList.add('obstacle', 'obstacle-bottom');
        bottomObstacle.style.left = gameWidth + 'px';
        bottomObstacle.style.height = (gameHeight - gapTop - obstacleGap) + 'px';
        gameContainer.appendChild(bottomObstacle);
        
        let mantineElement = null;
        if (Math.random() < 0.35) {
            mantineElement = document.createElement('div');
            mantineElement.classList.add('mantine');
            mantineElement.style.left = gameWidth + 'px';
            const center = gapTop + obstacleGap / 2;
            const mantineTop = center - 10;
            mantineElement.style.top = Math.max(50, Math.min(gameHeight - 50, mantineTop)) + 'px';
            gameContainer.appendChild(mantineElement);
        }

        obstacles.push({
            left: gameWidth,
            gapTop: gapTop,
            topElement: topObstacle,
            bottomElement: bottomObstacle,
            mantineElement: mantineElement,
            mantineWidth: 60,
            mantineHeight: 40,
            passed: false
        });
    }

    function endGame(animate = true) {
        gameRunning = false;
        clearInterval(gameLoop);
        clearInterval(obstacleInterval);
        clearInterval(coinInterval);
        if (kyogreTimer) clearTimeout(kyogreTimer);
        document.querySelectorAll('.kyogre').forEach(k => k.remove());
        kyogres = [];

        if (!animate) {
            finalScoreDisplay.textContent = score;
            gameOverScreen.classList.remove('hidden');
            return;
        }

        if (!magikarp.classList.contains('dead')) {
            magikarp.classList.add('dead');
            magikarp.addEventListener('animationend', () => {
                finalScoreDisplay.textContent = score;
                gameOverScreen.classList.remove('hidden');
            }, { once: true });
        } else {
            finalScoreDisplay.textContent = score;
            gameOverScreen.classList.remove('hidden');
        }
    }

    document.addEventListener('keydown', (e) => {
        if (e.code === 'Space') {
            e.preventDefault();
            jump();
        }
    });

    document.addEventListener('click', () => {
        if (gameRunning) jump();
    });

    startButton.addEventListener('click', startGame);
    restartButton.addEventListener('click', startGame);

    // Instrucciones
    showInstructionsBtn.addEventListener('click', () => {
        startScreen.classList.add('hidden');
        instructionsScreen.classList.remove('hidden');
    });

    backToMenuBtn.addEventListener('click', () => {
        instructionsScreen.classList.add('hidden');
        startScreen.classList.remove('hidden');
    });

    init();
});
    </script>
    <script src="./js/compartir.js"></script>
    <script src="./js/comentario.js"></script>
    <script src="./js/sidebar.js"></script>
    <script src="./js/carrusel.js"></script>
    <script src="./js/recargar.js"></script>

</body>

</html>
    <script src="./js/compartir.js"></script>
    <script src="./js/comentario.js"></script>
    <script src="./js/sidebar.js"></script>
    <script src="./js/carrusel.js"></script>
    <script src="./js/recargar.js"></script>

</body>

</html>